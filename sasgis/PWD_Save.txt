Для того чтобы не хранить логин и пароль в файле INI, можно настроить сохранение логина и пароля в других местах в зашифрованном виде.

Логин и пароль хранятся вместе, для каждого сервера БД независимо.

Сохранить их можно как в реестре, так и в специальном хранилище "секретов" Lsa.

Защищённое хранилище (Protected Storage) не поддерживается.

Сохранение пароля осуществляется в Tile Storage Options после того, как попытка подключения к серверу БД оказалась неуспешной.



Для сохранения логина и пароля в реестре необходимо для конкретного сервера БД в его секции в INI указать параметр $PWD_Save=1.

Пример:
[PostgreSQL_OdbcW\$]
DSN=PostgreSQL_OdbcW
$ODBC_ConnectWithParams=0
$SYNC_SQL_MODE=0
$PWD_Save=1

В этом случае логин и пароль будут сохраняться в разделе реестра HKEY_CURRENT_USER\Software\VSA\DBMS и читаться оттуда по мере необходимости.
Причём через RegEdit посмотреть даже зашифрованное значение будет невозможно.
Можно только удалить весь раздел DBMS со всеми параметрами (для всех серверов БД).
Так что сохранённые логин и пароль будут доступны только для текущего пользователя.



Для сохранения логина и пароля как "секрет" Lsa необходимо для конкретного сервера БД в его секции в INI указать параметр $PWD_Save=Lsa.

Пример:
[PostgreSQL_OdbcW\$]
DSN=PostgreSQL_OdbcW
$ODBC_ConnectWithParams=0
$SYNC_SQL_MODE=0
$PWD_Save=Lsa

В этом случае логин и пароль будут сохраняться как локальный "секрет" доступный только на текущем компьютере.
Правда с доступностью этого "секрета" есть тонкость: при сохранении внутри Lsa данные получают такой DACL,
что доступны только создателю либо администраторам. При этом они дополнительно шифруются.
Подробности в MSDN (см. LsaStorePrivateData).
Таким образом, не представляется возможным однозначно утверждать, кому будут доступны логин и пароль.
Однако такой вариант может быть удобен, если доступ к программе осуществляется по сети с разных компьютеров,
на которых локальные пользователи обладают соответствующими привилегиями.



Если указать значение $PWD_Save=0 - сохранение логина и пароля (а также использование сохранённых ранее логинов и паролей) будет отключено.
В этом случае в зависимости от используемого для подключения драйвера и собственно в зависимости от сервера БД возможны 2 варианта:
1. Для подключения будут использоваться логин и пароль, сохранённые в System DSN.
2. Для подключения будет использоваться текущий (системный) логин пользователя.



При использовании описанной функциональности по умолчанию рекомендуется сохранение логинов и паролей в реестре.
Во всех случаях логин и пароль сохраняются в зашифрованном виде.
