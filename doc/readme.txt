А.

Файл TileStorage_DBMS.dll надо положить в папку с SASPlanet.exe.
Рядом с ним положить файл TileStorage_DBMS.ini с настройками подключения к СУБД.
В файле TileStorage_DBMS.ini настройки должны быть актуальными, а не из приложенного примера.

Также необходимо создать подпапку DBMS и в неё сложить скрипты для начального заполнения БД.
Это файлы TileStorage_DBMS.<XXX>.sql и TileStorage_DBMS.<XXX>.xql.
В зависимости от типа СУБД <XXX> заменяется на сокращение:
MS  - Microsoft SQL Server
ASE - Sybase ASE
ASA - Sybase ASA
ORA - Oracle
IFX - Informix
DB2 - DB2
MY  - MySQL
PG  - PostgreSQL
MMR - MimerSQL
FB  - Firebird




Б.

ВНИМАНИЕ!
Создание/установку сервера БД, собственно БД, устройств и прочее (в заависимости от типа СУБД),
и какую-либо их настройку DLL НЕ ВЫПОЛНЯЕТ!
Это относится исключительно к компетенции администратора БД.




В.

Не забудьте в ZMP установить CacheType=7.
А то всё полетит в файловую систему.




Г.

Далее приведено описание файла TileStorage_DBMS.ini.

Файл делится на секции стандартным способом.
В рамках секции описываются параметры ровно одного подключения (исключение - секционирование хранилища, см. файл TSS.txt).

Путь до СУБД-хранилища тайлов в сасе кодируется как S\D\T (например, PostgreSQL_OdbcW\$\googlesat), где
S - сервер (в примере PostgreSQL_OdbcW).
D - база (не для всех типов СУБД, в примере отсутствует, так как используется символ "$").
T - таблица, вернее - несколько таблиц, так как указывается только "родовое" имя (в примере googlesat).

Дабы не усложнять настройки, такое трёхчастное кодирование применяется даже в тех случаях, когда СУБД не делится на различные БД.
В этом случае вместо D можно использовать символ $.

В общем смысле первые 2 части S\D (в примере PostgreSQL_OdbcW\$) используются для идентификации сущности, к которой производится подключение с указанными настройками.
Несмотря на то что подключение формально осуществляется только к S, при доступе к разным D в рамках S могут использоваться разные настройки.
Поэтому аутентификация выполняется в разрезе S, а настройки подключения - в разрезе S\D.

В качестве источников ODBC используются только системные (System DSN).




Д.

При работе через ODBC используются следующие имена параметров (с примерами; не все параметры необходимы для конкретного типа СУБД):

DSN=PostgreSQL_OdbcW
Указывается реальное имя System DSN (при работе через DSN, см. ниже параметр $ODBC_ConnectWithParams).

UID=sa
Указывается логин (при работе через DSN, см. ниже параметр $ODBC_ConnectWithParams).

PWD=123456
Указывается пароль (при работе через DSN, см. ниже параметр $ODBC_ConnectWithParams).

DRIVER={SQL Server Native Client 10.0}
SERVER=LOCALHOST
Database=sas_db
trusted_connection=yes
Mars_Connection=yes
Параметры (в том числе любые другие) для формирования строки подключения (при работе НЕ через DSN, см. ниже параметр $ODBC_ConnectWithParams).




Е.

В секциях могут использоваться так называемые "внутренние" параметры. Все они начинаются с символа $.
они обрабатываются только в рамках DLL и гарантировано не передаются в драйвер подключения к СУБД.
Список "внутренних" параметров заведомо неполон, так как некоторые из них созданы исключительно для отладки.
Тем не менее необходимо упомянуть следующие:

$ODBC_ConnectWithParams=0
Отключает (по умолчанию) или включает (если значение равно 1) подключение не через параметры SystemDSN, а через ConnectionString.
Примеры использования есть в приложенном файле TileStorage_DBMS.ini.


$PWD_Save=Lsa
См. файл PWD_Save.txt

$LOAD_LIBRARY_ALT=C:\Program Files\PostgreSQL\9.2\bin\libpq.dll
$LOAD_LIBRARY=C:\Program Files\Common Files\MariaDBShared\HeidiSQL\libmysql.dll
Перед подключением будет произведена загрузка указанной библиотеки.
Если имя параметра с _ALT - загрузка будет произведена исходя из альтернативного алгоритма поиска DLL.
В этом случае все "дочерние" DLL будут сперва искаться в той же папке, что и указанная DLL.
Если же имя параметра без _ALT - будет использован стандартный алгоритм поиска DLL для "дочерних" библиотек.

Также в секциях могут использоваться параметры секционирования хранилища.
Все они начинаются на $TSS_ и описаны в файле TSS.txt.
